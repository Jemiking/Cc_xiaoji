# æ¶æ„è¿ç§»æ£€æŸ¥æ¸…å•å’Œæ•…éšœæ’é™¤æŒ‡å—

## 1. è¿ç§»å‰æ£€æŸ¥æ¸…å•

### 1.1 ç¯å¢ƒå‡†å¤‡
- [ ] Android Studio ç‰ˆæœ¬ >= 2023.1.1
- [ ] Gradle ç‰ˆæœ¬ = 8.4
- [ ] JDK ç‰ˆæœ¬ = 17
- [ ] æ‰€æœ‰å›¢é˜Ÿæˆå‘˜ç¯å¢ƒä¸€è‡´
- [ ] Gitä»“åº“å¹²å‡€ï¼ˆæ— æœªæäº¤æ›´æ”¹ï¼‰
- [ ] åˆ›å»ºè¿ç§»åˆ†æ”¯
- [ ] å®Œæ•´é¡¹ç›®å¤‡ä»½

### 1.2 ä»£ç å‡†å¤‡
- [ ] ç°æœ‰ä»£ç é€šè¿‡æ‰€æœ‰æµ‹è¯•
- [ ] ä»£ç è¦†ç›–ç‡åŸºå‡†è®°å½•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•å®Œæˆ
- [ ] ä¾èµ–å…³ç³»æ–‡æ¡£åŒ–
- [ ] æ•°æ®åº“schemaå¯¼å‡º

### 1.3 å›¢é˜Ÿå‡†å¤‡
- [ ] è¿ç§»è®¡åˆ’å·²æ²Ÿé€š
- [ ] è´£ä»»åˆ†å·¥æ˜ç¡®
- [ ] åº”æ€¥è”ç³»æ–¹å¼ç¡®è®¤
- [ ] å›æ»šæµç¨‹å·²æ¼”ç»ƒ

## 2. æ¨¡å—åˆ›å»ºæ£€æŸ¥æ¸…å•

### 2.1 åˆ›å»ºæ–°æ¨¡å—æ—¶
```bash
# æ£€æŸ¥è„šæœ¬
#!/bin/bash
# scripts/check-module-creation.sh

MODULE_NAME=$1
MODULE_PATH="feature/$MODULE_NAME"

echo "Checking module: $MODULE_NAME"

# 1. æ£€æŸ¥ç›®å½•ç»“æ„
if [ ! -d "$MODULE_PATH/api" ]; then
    echo "âŒ Missing api directory"
    exit 1
fi

if [ ! -d "$MODULE_PATH/data" ]; then
    echo "âŒ Missing data directory"
    exit 1
fi

if [ ! -d "$MODULE_PATH/domain" ]; then
    echo "âŒ Missing domain directory"
    exit 1
fi

if [ ! -d "$MODULE_PATH/presentation" ]; then
    echo "âŒ Missing presentation directory"
    exit 1
fi

# 2. æ£€æŸ¥build.gradle.kts
if [ ! -f "$MODULE_PATH/build.gradle.kts" ]; then
    echo "âŒ Missing build.gradle.kts"
    exit 1
fi

# 3. æ£€æŸ¥æ˜¯å¦åœ¨settings.gradle.ktsä¸­æ³¨å†Œ
if ! grep -q ":feature:$MODULE_NAME" settings.gradle.kts; then
    echo "âŒ Module not registered in settings.gradle.kts"
    exit 1
fi

echo "âœ… Module structure check passed"
```

### 2.2 æ¨¡å—é…ç½®éªŒè¯
- [ ] build.gradle.kts ä½¿ç”¨conventionæ’ä»¶
- [ ] æ­£ç¡®çš„namespaceé…ç½®
- [ ] ä¾èµ–åªå¼•ç”¨allowedæ¨¡å—
- [ ] æ²¡æœ‰å¾ªç¯ä¾èµ–
- [ ] ProGuardè§„åˆ™é…ç½®ï¼ˆå¦‚éœ€è¦ï¼‰

## 3. ä»£ç è¿ç§»æ£€æŸ¥æ¸…å•

### 3.1 è¿ç§»å•ä¸ªç±»æ—¶
1. **å¤åˆ¶é˜¶æ®µ**
   - [ ] åœ¨æ–°æ¨¡å—åˆ›å»ºå¯¹åº”åŒ…ç»“æ„
   - [ ] å¤åˆ¶ç±»æ–‡ä»¶ï¼ˆä¸æ˜¯ç§»åŠ¨ï¼‰
   - [ ] æ›´æ–°packageå£°æ˜
   - [ ] æ›´æ–°importè¯­å¥

2. **é€‚é…é˜¶æ®µ**
   - [ ] æ£€æŸ¥ä¾èµ–æ˜¯å¦éƒ½å¯è®¿é—®
   - [ ] æ›´æ–°ä¾èµ–æ³¨å…¥é…ç½®
   - [ ] æ·»åŠ å¿…è¦çš„å†…éƒ¨ä¾èµ–

3. **æµ‹è¯•é˜¶æ®µ**
   - [ ] ä¸ºæ–°ä½ç½®çš„ç±»ç¼–å†™æµ‹è¯•
   - [ ] è¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸
   - [ ] å¯¹æ¯”æ–°æ—§å®ç°è¡Œä¸º

4. **åˆ‡æ¢é˜¶æ®µ**
   - [ ] é€šè¿‡åŠŸèƒ½å¼€å…³æ§åˆ¶ä½¿ç”¨æ–°/æ—§å®ç°
   - [ ] ç›‘æ§å¼‚å¸¸å’Œæ€§èƒ½æŒ‡æ ‡
   - [ ] ç¡®è®¤æ— é—®é¢˜ååˆ é™¤æ—§ä»£ç 

### 3.2 è¿ç§»æ£€æŸ¥è„šæœ¬
```kotlin
// buildSrc/src/main/kotlin/MigrationChecker.kt
import org.gradle.api.DefaultTask
import org.gradle.api.tasks.TaskAction

open class MigrationChecker : DefaultTask() {
    @TaskAction
    fun check() {
        // 1. æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„ç±»
        checkDuplicateClasses()
        
        // 2. æ£€æŸ¥importæ˜¯å¦æ­£ç¡®æ›´æ–°
        checkImports()
        
        // 3. æ£€æŸ¥ä¾èµ–æ³¨å…¥é…ç½®
        checkDependencyInjection()
    }
    
    private fun checkDuplicateClasses() {
        // æ‰«ææ‰€æœ‰æ¨¡å—ï¼ŒæŸ¥æ‰¾é‡å¤çš„ç±»å
    }
}
```

## 4. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 4.1 ç¼–è¯‘é”™è¯¯

#### é—®é¢˜ï¼šUnresolved reference
```
åŸå› ï¼šç±»è¿ç§»åï¼Œå¼•ç”¨è·¯å¾„æœªæ›´æ–°
è§£å†³ï¼š
1. ä½¿ç”¨ Android Studio çš„ "Optimize Imports"
2. å…¨å±€æœç´¢æ›¿æ¢æ—§çš„importè·¯å¾„
3. æ£€æŸ¥æ¨¡å—ä¾èµ–æ˜¯å¦æ­£ç¡®é…ç½®
```

#### é—®é¢˜ï¼šDuplicate class found
```
åŸå› ï¼šæ–°æ—§ä»£ç åŒæ—¶å­˜åœ¨
è§£å†³ï¼š
1. ç¡®ä¿ä½¿ç”¨åŠŸèƒ½å¼€å…³æ§åˆ¶
2. æ£€æŸ¥ProGuardè§„åˆ™æ˜¯å¦å†²çª
3. æ¸…ç†æ„å»ºç¼“å­˜ï¼š./gradlew clean
```

### 4.2 è¿è¡Œæ—¶é”™è¯¯

#### é—®é¢˜ï¼šClassNotFoundException
```
åŸå› ï¼šProGuard/R8æ··æ·†äº†ç±»å
è§£å†³ï¼š
1. æ·»åŠ keepè§„åˆ™
2. æ£€æŸ¥æ··æ·†æ˜ å°„æ–‡ä»¶
3. åœ¨å¯¹åº”æ¨¡å—æ·»åŠ consumer-rules.pro
```

#### é—®é¢˜ï¼šHiltä¾èµ–æ³¨å…¥å¤±è´¥
```
åŸå› ï¼šæ¨¡å—è¾¹ç•Œå¯¼è‡´Hiltæ— æ³•æ‰¾åˆ°ä¾èµ–
è§£å†³ï¼š
1. ç¡®ä¿@InstallInçš„scopeæ­£ç¡®
2. æ£€æŸ¥æ¨¡å—æ˜¯å¦æ­£ç¡®é…ç½®Hiltæ’ä»¶
3. ä½¿ç”¨@EntryPointæš´éœ²ä¾èµ–
```

### 4.3 æ•°æ®åº“ç›¸å…³

#### é—®é¢˜ï¼šRoom database migration failed
```
åŸå› ï¼šå®ä½“ç±»ä½ç½®æ”¹å˜å½±å“æ•°æ®åº“
è§£å†³ï¼š
1. ä¿æŒEntityçš„å®Œæ•´ç±»åä¸å˜
2. ä½¿ç”¨@TypeConvertersæ—¶æ³¨æ„è·¯å¾„
3. å¿…è¦æ—¶ä½¿ç”¨exportSchemaéªŒè¯
```

### 4.4 æµ‹è¯•ç›¸å…³

#### é—®é¢˜ï¼šTest configuration not found
```
åŸå› ï¼šæµ‹è¯•é…ç½®æœªè¿ç§»
è§£å†³ï¼š
1. ç¡®ä¿æµ‹è¯•ä¾èµ–æ­£ç¡®é…ç½®
2. æ£€æŸ¥AndroidManifest.xmlä¸­çš„æµ‹è¯•é…ç½®
3. ä½¿ç”¨shared testé…ç½®
```

## 5. æ€§èƒ½ç›‘æ§æ£€æŸ¥

### 5.1 æ„å»ºæ€§èƒ½
```bash
# ç›‘æ§æ„å»ºæ—¶é—´
./gradlew build --profile

# åˆ†æä»»åŠ¡è€—æ—¶
./gradlew buildHealth
```

### 5.2 è¿è¡Œæ—¶æ€§èƒ½
```kotlin
// æ·»åŠ æ€§èƒ½ç›‘æ§
class PerformanceMonitor {
    fun trackModuleLoadTime(moduleName: String) {
        val startTime = System.currentTimeMillis()
        // æ¨¡å—åŠ è½½
        val loadTime = System.currentTimeMillis() - startTime
        
        Firebase.Analytics.logEvent("module_load_time") {
            param("module_name", moduleName)
            param("load_time_ms", loadTime)
        }
    }
}
```

## 6. å›æ»šæ£€æŸ¥æ¸…å•

### 6.1 ç´§æ€¥å›æ»šï¼ˆ<5åˆ†é’Ÿï¼‰
1. [ ] å…³é—­åŠŸèƒ½å¼€å…³
2. [ ] é€šçŸ¥å›¢é˜Ÿæˆå‘˜
3. [ ] è®°å½•é—®é¢˜ç°è±¡
4. [ ] æ”¶é›†é”™è¯¯æ—¥å¿—

### 6.2 ä»£ç å›æ»šï¼ˆ<30åˆ†é’Ÿï¼‰
1. [ ] åˆ‡æ¢åˆ°ç¨³å®šåˆ†æ”¯
2. [ ] è¿è¡Œå›å½’æµ‹è¯•
3. [ ] éƒ¨ç½²å›æ»šç‰ˆæœ¬
4. [ ] éªŒè¯åŠŸèƒ½æ¢å¤

### 6.3 æ•°æ®å›æ»šï¼ˆ<2å°æ—¶ï¼‰
1. [ ] åœæ­¢å†™å…¥æ“ä½œ
2. [ ] å¤‡ä»½å½“å‰æ•°æ®
3. [ ] æ‰§è¡Œå›æ»šè„šæœ¬
4. [ ] éªŒè¯æ•°æ®å®Œæ•´æ€§

## 7. è‡ªåŠ¨åŒ–éªŒè¯å·¥å…·

### 7.1 CI/CDé…ç½®
```yaml
# .github/workflows/migration-check.yml
name: Migration Validation

on:
  pull_request:
    branches: [ feature/modular-architecture ]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Check module structure
        run: ./scripts/check-module-structure.sh
      
      - name: Run migration tests
        run: ./gradlew migrationTest
      
      - name: Check for duplicate classes
        run: ./gradlew checkDuplicates
      
      - name: Verify no breaking changes
        run: ./gradlew apiCheck
```

### 7.2 æœ¬åœ°éªŒè¯è„šæœ¬
```bash
#!/bin/bash
# scripts/pre-migration-check.sh

echo "Running pre-migration checks..."

# 1. æ£€æŸ¥GitçŠ¶æ€
if [ -n "$(git status --porcelain)" ]; then
    echo "âŒ Working directory not clean"
    exit 1
fi

# 2. è¿è¡Œæ‰€æœ‰æµ‹è¯•
./gradlew test
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed"
    exit 1
fi

# 3. æ£€æŸ¥ä»£ç è¦†ç›–ç‡
./gradlew koverVerify
if [ $? -ne 0 ]; then
    echo "âŒ Code coverage below threshold"
    exit 1
fi

# 4. æ„å»ºAPK
./gradlew assembleDebug
if [ $? -ne 0 ]; then
    echo "âŒ Build failed"
    exit 1
fi

echo "âœ… All pre-migration checks passed"
```

## 8. è¿ç§»è¿›åº¦è¿½è¸ª

### 8.1 æ¯æ—¥ç«™ä¼šæ£€æŸ¥é¡¹
- æ˜¨å¤©å®Œæˆäº†å“ªäº›è¿ç§»ï¼Ÿ
- é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ
- ä»Šå¤©è®¡åˆ’è¿ç§»ä»€ä¹ˆï¼Ÿ
- éœ€è¦ä»€ä¹ˆå¸®åŠ©ï¼Ÿ

### 8.2 å‘¨æŠ¥æ¨¡æ¿
```markdown
## è¿ç§»å‘¨æŠ¥ - Week X

### å®Œæˆæƒ…å†µ
- âœ… æ¨¡å—Aè¿ç§»å®Œæˆ
- ğŸ”„ æ¨¡å—Bè¿ç§»è¿›è¡Œä¸­ (60%)
- â³ æ¨¡å—Cå¾…å¼€å§‹

### é—®é¢˜å’Œé£é™©
1. é—®é¢˜ï¼šXXX
   - å½±å“ï¼šXXX
   - è§£å†³æ–¹æ¡ˆï¼šXXX
   
### ä¸‹å‘¨è®¡åˆ’
- [ ] å®Œæˆæ¨¡å—Bè¿ç§»
- [ ] å¼€å§‹æ¨¡å—Cè¿ç§»
- [ ] æ€§èƒ½ä¼˜åŒ–

### åº¦é‡æŒ‡æ ‡
- ä»£ç è¡Œæ•°å‡å°‘ï¼š15%
- æ„å»ºæ—¶é—´ä¼˜åŒ–ï¼š-2åˆ†é’Ÿ
- æµ‹è¯•è¦†ç›–ç‡ï¼š85%
```

## 9. åº”æ€¥è”ç³»å’Œå‡çº§æœºåˆ¶

### 9.1 é—®é¢˜å‡çº§è·¯å¾„
1. **L1 - å¼€å‘è€…è‡ªè¡Œè§£å†³**ï¼ˆ<30åˆ†é’Ÿï¼‰
2. **L2 - å›¢é˜Ÿåä½œè§£å†³**ï¼ˆ<2å°æ—¶ï¼‰
3. **L3 - æ¶æ„å¸ˆä»‹å…¥**ï¼ˆ<4å°æ—¶ï¼‰
4. **L4 - ç´§æ€¥å›æ»š**ï¼ˆç«‹å³ï¼‰

### 9.2 å…³é”®è”ç³»äºº
- æ¶æ„è´Ÿè´£äººï¼šXXX
- è¿ç»´è´Ÿè´£äººï¼šXXX
- äº§å“è´Ÿè´£äººï¼šXXX
- ç´§æ€¥çƒ­çº¿ï¼šXXX

è¿™ä»½æ£€æŸ¥æ¸…å•å’Œæ•…éšœæ’é™¤æŒ‡å—èƒ½å¸®åŠ©å›¢é˜Ÿåœ¨è¿ç§»è¿‡ç¨‹ä¸­å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ï¼Œç¡®ä¿è¿ç§»è¿‡ç¨‹çš„é¡ºåˆ©è¿›è¡Œã€‚