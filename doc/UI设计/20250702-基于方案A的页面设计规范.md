# 基于方案A的页面设计规范

> **创建日期**: 2025-07-02  
> **设计方案**: 极简扁平化设计（方案A）  
> **参考基准**: HomeScreen主页优化后的最终效果

## 📌 设计演变说明

### 主页设计历程
1. **第一阶段**：现代化设计（毛玻璃、渐变、阴影）
2. **第二阶段**：极简扁平化（移除渐变、弱化阴影、降低饱和度）✅ 当前

基于用户反馈，主页最终采用了**极简扁平化方案（方案A）**，其他页面将严格遵循此设计语言。

## 🎨 核心设计原则

### 1. 视觉风格
- **扁平化设计**：无渐变、无毛玻璃效果
- **极弱阴影**：0-2dp，多数情况使用边框代替
- **柔和色调**：低饱和度的品牌色
- **细边框**：10-20%透明度
- **极淡背景**：5%透明度

### 2. 核心组件选择
```kotlin
// ✅ 使用这些组件
- FlatModuleCard    // 扁平模块卡片
- FlatButton        // 纯色按钮
- ModernCard        // 现代卡片（带细边框）
- MaterialTheme     // 语义化颜色

// ❌ 避免使用
- GradientButton    // 渐变按钮
- GlassCard         // 毛玻璃卡片
- 任何Brush渐变效果
- 硬编码颜色值
```

## 📱 具体页面设计方案

### 1. LedgerScreen（记账主界面）

#### 设计要点
```kotlin
// 顶部月度概览条
Box(
    modifier = Modifier
        .fillMaxWidth()
        .background(
            color = DesignTokens.BrandColors.Ledger.copy(alpha = 0.05f),
            shape = RoundedCornerShape(DesignTokens.BorderRadius.medium)
        )
        .border(
            width = 1.dp,
            color = DesignTokens.BrandColors.Ledger.copy(alpha = 0.2f),
            shape = RoundedCornerShape(DesignTokens.BorderRadius.medium)
        )
)

// 交易列表项
ModernCard(
    backgroundColor = MaterialTheme.colorScheme.surface,
    borderColor = MaterialTheme.colorScheme.outline.copy(alpha = 0.1f),
    elevation = 0.dp
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .padding(DesignTokens.Spacing.medium)
    ) {
        // 分类图标 - 使用扁平背景
        Box(
            modifier = Modifier
                .size(40.dp)
                .background(
                    color = categoryColor.copy(alpha = 0.1f),
                    shape = CircleShape
                )
        ) {
            Icon(
                imageVector = categoryIcon,
                tint = categoryColor,
                modifier = Modifier.align(Alignment.Center)
            )
        }
        
        // 交易信息
        Column(modifier = Modifier.weight(1f)) {
            Text(
                text = transactionName,
                style = MaterialTheme.typography.bodyLarge,
                color = MaterialTheme.colorScheme.onSurface
            )
            Text(
                text = accountName,
                style = MaterialTheme.typography.bodySmall,
                color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
            )
        }
        
        // 金额 - 使用语义化颜色
        Text(
            text = amount,
            style = MaterialTheme.typography.titleMedium,
            color = when(type) {
                TransactionType.INCOME -> DesignTokens.BrandColors.Success
                TransactionType.EXPENSE -> DesignTokens.BrandColors.Error
                else -> MaterialTheme.colorScheme.onSurface
            },
            fontWeight = FontWeight.Medium
        )
    }
}

// FAB - 扁平设计
FloatingActionButton(
    onClick = onAddTransaction,
    containerColor = DesignTokens.BrandColors.Ledger,
    elevation = FloatingActionButtonDefaults.elevation(
        defaultElevation = 1.dp,
        pressedElevation = 2.dp
    )
) {
    Icon(Icons.Default.Add, contentDescription = null, tint = Color.White)
}
```

#### 组件拆分方案
```
LedgerScreen.kt (主文件 ~400行)
├── components/
│   ├── MonthlyOverviewBar.kt
│   ├── TransactionItem.kt
│   ├── TransactionGroupHeader.kt
│   └── EmptyTransactionState.kt
├── dialogs/
│   ├── AddTransactionDialog.kt
│   ├── EditTransactionDialog.kt
│   └── FilterBottomSheet.kt
└── sections/
    ├── QuickStatsSection.kt
    └── BatchOperationBar.kt
```

### 2. TodoScreen（待办界面）

#### 设计要点
```kotlin
// 任务分组标题
Row(
    modifier = Modifier
        .fillMaxWidth()
        .padding(horizontal = DesignTokens.Spacing.medium, vertical = DesignTokens.Spacing.small)
) {
    Text(
        text = groupTitle, // "今天"、"明天"、"本周"
        style = MaterialTheme.typography.titleSmall,
        color = DesignTokens.BrandColors.Todo,
        fontWeight = FontWeight.Medium
    )
    Spacer(modifier = Modifier.weight(1f))
    Text(
        text = "$taskCount 项",
        style = MaterialTheme.typography.bodySmall,
        color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
    )
}

// 任务卡片
ModernCard(
    backgroundColor = MaterialTheme.colorScheme.surface,
    borderColor = priorityColor.copy(alpha = 0.2f),
    onClick = onTaskClick
) {
    Row(
        modifier = Modifier.padding(DesignTokens.Spacing.medium),
        verticalAlignment = Alignment.CenterVertically
    ) {
        // 完成状态复选框
        Checkbox(
            checked = task.isCompleted,
            onCheckedChange = onToggleComplete,
            colors = CheckboxDefaults.colors(
                checkedColor = DesignTokens.BrandColors.Todo,
                uncheckedColor = MaterialTheme.colorScheme.onSurfaceVariant
            )
        )
        
        Spacer(modifier = Modifier.width(DesignTokens.Spacing.small))
        
        // 任务内容
        Column(modifier = Modifier.weight(1f)) {
            Text(
                text = task.title,
                style = MaterialTheme.typography.bodyLarge,
                color = if (task.isCompleted) {
                    MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
                } else {
                    MaterialTheme.colorScheme.onSurface
                },
                textDecoration = if (task.isCompleted) TextDecoration.LineThrough else null
            )
            
            if (task.dueDate != null) {
                Text(
                    text = formatDueDate(task.dueDate),
                    style = MaterialTheme.typography.bodySmall,
                    color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
                )
            }
        }
        
        // 优先级指示器
        Box(
            modifier = Modifier
                .size(8.dp)
                .background(
                    color = priorityColor,
                    shape = CircleShape
                )
        )
    }
}

// 空状态
Column(
    modifier = Modifier
        .fillMaxSize()
        .padding(DesignTokens.Spacing.xxl),
    horizontalAlignment = Alignment.CenterHorizontally,
    verticalArrangement = Arrangement.Center
) {
    Icon(
        imageVector = Icons.Default.CheckCircle,
        contentDescription = null,
        modifier = Modifier.size(64.dp),
        tint = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.3f)
    )
    Spacer(modifier = Modifier.height(DesignTokens.Spacing.medium))
    Text(
        text = "没有待办事项",
        style = MaterialTheme.typography.titleMedium,
        color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
    )
    Spacer(modifier = Modifier.height(DesignTokens.Spacing.small))
    FlatButton(
        text = "添加任务",
        onClick = onAddTask,
        backgroundColor = DesignTokens.BrandColors.Todo
    )
}
```

### 3. HabitScreen（习惯界面）

#### 设计要点
```kotlin
// 习惯卡片
ModernCard(
    backgroundColor = MaterialTheme.colorScheme.surface,
    borderColor = habitColor.copy(alpha = 0.2f),
    onClick = onHabitClick
) {
    Column(modifier = Modifier.padding(DesignTokens.Spacing.medium)) {
        // 头部信息
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.SpaceBetween,
            verticalAlignment = Alignment.Top
        ) {
            Row(verticalAlignment = Alignment.CenterVertically) {
                // 习惯图标
                Box(
                    modifier = Modifier
                        .size(40.dp)
                        .background(
                            color = habitColor.copy(alpha = 0.1f),
                            shape = CircleShape
                        )
                ) {
                    Icon(
                        imageVector = habitIcon,
                        contentDescription = null,
                        tint = habitColor,
                        modifier = Modifier
                            .size(24.dp)
                            .align(Alignment.Center)
                    )
                }
                
                Spacer(modifier = Modifier.width(DesignTokens.Spacing.small))
                
                Column {
                    Text(
                        text = habit.name,
                        style = MaterialTheme.typography.titleMedium,
                        fontWeight = FontWeight.Medium
                    )
                    Text(
                        text = "连续 $streakDays 天",
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
                    )
                }
            }
            
            // 今日状态
            if (!habit.isCheckedToday) {
                FlatButton(
                    text = "打卡",
                    onClick = onCheckIn,
                    modifier = Modifier.height(32.dp),
                    backgroundColor = habitColor,
                    contentPadding = PaddingValues(horizontal = 16.dp, vertical = 0.dp)
                )
            } else {
                Icon(
                    imageVector = Icons.Default.CheckCircle,
                    contentDescription = "已完成",
                    tint = DesignTokens.BrandColors.Success,
                    modifier = Modifier.size(24.dp)
                )
            }
        }
        
        Spacer(modifier = Modifier.height(DesignTokens.Spacing.small))
        
        // 进度条
        LinearProgressIndicator(
            progress = weeklyProgress,
            modifier = Modifier
                .fillMaxWidth()
                .height(4.dp)
                .clip(RoundedCornerShape(2.dp)),
            color = habitColor,
            trackColor = habitColor.copy(alpha = 0.1f)
        )
        
        Spacer(modifier = Modifier.height(DesignTokens.Spacing.xs))
        
        Text(
            text = "本周 $checkedDays/$targetDays 天",
            style = MaterialTheme.typography.labelSmall,
            color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
        )
    }
}

// 统计视图 - 极简化
Card(
    modifier = Modifier.fillMaxWidth(),
    colors = CardDefaults.cardColors(
        containerColor = MaterialTheme.colorScheme.surfaceVariant.copy(alpha = 0.5f)
    ),
    elevation = CardDefaults.cardElevation(defaultElevation = 0.dp),
    border = BorderStroke(
        width = 1.dp,
        color = MaterialTheme.colorScheme.outline.copy(alpha = 0.1f)
    )
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .padding(DesignTokens.Spacing.medium),
        horizontalArrangement = Arrangement.SpaceEvenly
    ) {
        StatItem(
            value = "$totalCheckIns",
            label = "总打卡",
            color = DesignTokens.BrandColors.Success
        )
        StatItem(
            value = "$longestStreak",
            label = "最长连续",
            color = DesignTokens.BrandColors.Warning
        )
        StatItem(
            value = "$completionRate%",
            label = "完成率",
            color = DesignTokens.BrandColors.Info
        )
    }
}
```

### 4. ProfileScreen（个人中心）

#### 设计要点
```kotlin
// 个人信息卡片
ModernCard(
    backgroundColor = MaterialTheme.colorScheme.primaryContainer.copy(alpha = 0.05f),
    borderColor = MaterialTheme.colorScheme.primary.copy(alpha = 0.2f)
) {
    Row(
        modifier = Modifier
            .fillMaxWidth()
            .padding(DesignTokens.Spacing.large),
        verticalAlignment = Alignment.CenterVertically
    ) {
        // 头像占位
        Box(
            modifier = Modifier
                .size(64.dp)
                .background(
                    color = MaterialTheme.colorScheme.primary.copy(alpha = 0.1f),
                    shape = CircleShape
                )
        ) {
            Icon(
                imageVector = Icons.Default.Person,
                contentDescription = null,
                tint = MaterialTheme.colorScheme.primary,
                modifier = Modifier
                    .size(32.dp)
                    .align(Alignment.Center)
            )
        }
        
        Spacer(modifier = Modifier.width(DesignTokens.Spacing.medium))
        
        Column {
            Text(
                text = user.name,
                style = MaterialTheme.typography.titleLarge,
                fontWeight = FontWeight.Medium
            )
            Text(
                text = "使用 $daysSinceJoined 天",
                style = MaterialTheme.typography.bodyMedium,
                color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
            )
        }
    }
}

// 设置分组
Column(
    modifier = Modifier.fillMaxWidth(),
    verticalArrangement = Arrangement.spacedBy(DesignTokens.Spacing.small)
) {
    Text(
        text = "基础设置",
        style = MaterialTheme.typography.titleSmall,
        color = MaterialTheme.colorScheme.primary,
        modifier = Modifier.padding(horizontal = DesignTokens.Spacing.medium)
    )
    
    SettingItem(
        icon = Icons.Default.ColorLens,
        title = "主题设置",
        subtitle = "深色模式、动态颜色",
        onClick = onThemeSettings
    )
    
    SettingItem(
        icon = Icons.Default.Notifications,
        title = "通知设置",
        subtitle = "提醒、声音、振动",
        onClick = onNotificationSettings
    )
}

// 设置项组件
@Composable
fun SettingItem(
    icon: ImageVector,
    title: String,
    subtitle: String? = null,
    onClick: () -> Unit
) {
    ModernCard(
        onClick = onClick,
        backgroundColor = MaterialTheme.colorScheme.surface,
        borderColor = Color.Transparent,
        elevation = 0.dp
    ) {
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(
                    horizontal = DesignTokens.Spacing.medium,
                    vertical = DesignTokens.Spacing.medium
                ),
            verticalAlignment = Alignment.CenterVertically
        ) {
            Icon(
                imageVector = icon,
                contentDescription = null,
                tint = MaterialTheme.colorScheme.onSurfaceVariant,
                modifier = Modifier.size(24.dp)
            )
            
            Spacer(modifier = Modifier.width(DesignTokens.Spacing.medium))
            
            Column(modifier = Modifier.weight(1f)) {
                Text(
                    text = title,
                    style = MaterialTheme.typography.bodyLarge
                )
                subtitle?.let {
                    Text(
                        text = it,
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
                    )
                }
            }
            
            Icon(
                imageVector = Icons.Default.ChevronRight,
                contentDescription = null,
                tint = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f),
                modifier = Modifier.size(20.dp)
            )
        }
    }
}
```

## 🎨 通用组件规范

### 1. 标准列表项
```kotlin
@Composable
fun FlatListItem(
    title: String,
    subtitle: String? = null,
    leadingContent: @Composable (() -> Unit)? = null,
    trailingContent: @Composable (() -> Unit)? = null,
    onClick: (() -> Unit)? = null,
    modifier: Modifier = Modifier
) {
    val containerModifier = if (onClick != null) {
        modifier.clickable { onClick() }
    } else modifier
    
    Surface(
        modifier = containerModifier,
        color = MaterialTheme.colorScheme.surface,
        shape = RoundedCornerShape(DesignTokens.BorderRadius.medium)
    ) {
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .padding(DesignTokens.Spacing.medium),
            verticalAlignment = Alignment.CenterVertically
        ) {
            leadingContent?.invoke()
            
            if (leadingContent != null) {
                Spacer(modifier = Modifier.width(DesignTokens.Spacing.medium))
            }
            
            Column(modifier = Modifier.weight(1f)) {
                Text(
                    text = title,
                    style = MaterialTheme.typography.bodyLarge,
                    color = MaterialTheme.colorScheme.onSurface
                )
                subtitle?.let {
                    Text(
                        text = it,
                        style = MaterialTheme.typography.bodySmall,
                        color = MaterialTheme.colorScheme.onSurfaceVariant.copy(alpha = 0.6f)
                    )
                }
            }
            
            trailingContent?.invoke()
        }
    }
}
```

### 2. 扁平对话框
```kotlin
@Composable
fun FlatDialog(
    onDismissRequest: () -> Unit,
    title: String,
    content: @Composable () -> Unit,
    confirmButton: @Composable () -> Unit,
    dismissButton: @Composable (() -> Unit)? = null
) {
    AlertDialog(
        onDismissRequest = onDismissRequest,
        title = {
            Text(
                text = title,
                style = MaterialTheme.typography.headlineSmall,
                fontWeight = FontWeight.Medium
            )
        },
        text = content,
        confirmButton = confirmButton,
        dismissButton = dismissButton,
        shape = RoundedCornerShape(DesignTokens.BorderRadius.large),
        containerColor = MaterialTheme.colorScheme.surface,
        tonalElevation = 0.dp
    )
}
```

### 3. 扁平FAB
```kotlin
@Composable
fun FlatFAB(
    onClick: () -> Unit,
    modifier: Modifier = Modifier,
    containerColor: Color = MaterialTheme.colorScheme.primary,
    content: @Composable () -> Unit
) {
    FloatingActionButton(
        onClick = onClick,
        modifier = modifier,
        containerColor = containerColor,
        contentColor = Color.White,
        elevation = FloatingActionButtonDefaults.elevation(
            defaultElevation = 1.dp,
            pressedElevation = 2.dp,
            focusedElevation = 1.dp,
            hoveredElevation = 2.dp
        ),
        shape = RoundedCornerShape(DesignTokens.BorderRadius.large)
    ) {
        content()
    }
}
```

## 📐 统一规范总结

### 颜色使用
1. **主色调**：使用DesignTokens.BrandColors中的柔和色
2. **透明度**：
   - 背景：5%
   - 边框：10-20%
   - 次要文字：60%
   - 禁用状态：30%

### 间距规范
- 卡片内边距：16dp (medium)
- 卡片间距：16dp (medium)  
- 元素间距：8dp (small)
- 图标文字间距：8dp (small)

### 圆角规范
- 按钮：4dp (small)
- 卡片：8dp (medium)
- 对话框：12dp (large)
- FAB：12dp (large)

### 阴影规范
- 普通卡片：0dp (使用边框)
- FAB：1dp
- 对话框：0dp (使用tonalElevation)

## 🚀 实施步骤

1. **第一步**：创建通用组件（FlatDialog、FlatFAB、FlatListItem等）
2. **第二步**：按优先级逐个优化页面
3. **第三步**：统一测试验证

---

**核心原则**：保持极简、突出内容、统一风格