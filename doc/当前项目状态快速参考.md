# 当前项目状态快速参考

## 最后更新：2025年6月14日

## 🎉 项目概况
- **项目名称**：CC小记（生活管理超级应用）
- **技术栈**：Kotlin + Jetpack Compose + Room + Hilt + Coroutines
- **架构模式**：领域驱动模块化架构（Clean Architecture）
- **数据库版本**：6（包含排班模块索引优化）
- **最低SDK**：26 (Android 8.0)
- **目标SDK**：34
- **Kotlin版本**：1.9.21

## 🏗️ 架构状态

### 架构迁移已完成！✅
- **迁移周期**：6个月（2025年1月 - 2025年6月）
- **模块数量**：11个模块
  - 1个 app 模块（应用外壳）
  - 4个 core 模块（基础设施）
  - 4个 feature 模块（业务功能）
  - 4个 shared 模块（共享业务）

### 模块结构
```
Cc_xiaoji/
├── app/                    # 应用入口、全局导航
├── core/
│   ├── common/            # 基础工具、扩展函数
│   ├── database/          # Room数据库
│   ├── ui/                # UI主题、通用组件
│   └── data/              # 数据层基础设施
├── feature/
│   ├── ledger/            # 记账功能（8个子功能）
│   ├── todo/              # 待办功能
│   ├── habit/             # 习惯功能
│   └── schedule/          # 排班功能（新增）
└── shared/
    ├── user/              # 用户管理
    ├── sync/              # 数据同步
    ├── backup/            # 备份恢复
    └── notification/      # 通知管理
```

## 📱 功能模块状态

### 1. 记账模块（Ledger）✅
- 账户管理（多账户、信用卡）
- 交易记录（收支记录）
- 预算管理（月度/年度）
- 分类管理（层级分类）
- 存钱目标（储蓄计划）
- 统计分析（图表报表）
- 定期交易（自动记账）
- 信用卡管理（账单、还款）

### 2. 待办模块（Todo）✅
- 任务创建/编辑/删除
- 任务搜索和筛选
- 优先级和截止日期
- 任务提醒通知

### 3. 习惯模块（Habit）✅
- 习惯创建/编辑/删除
- 打卡记录和连续天数
- 习惯统计和图表
- 习惯提醒通知

### 4. 排班模块（Schedule）✅
- 班次管理（创建、编辑、激活/停用）
- 灵活排班（单日、批量、循环、轮班）
- 日历视图（月度展示、快速导航）
- 统计分析（工时统计、班次分布）
- 数据导出（CSV、JSON格式）
- 排班提醒（通知管理）

## 🚀 最近完成的工作（2025-06-14）

### 排班模块优化
1. **代码清理**
   - 删除未使用的导入
   - 移除调试代码（TODO注释、Log语句）
   - 统一代码风格（导入排序、KDoc注释）

2. **性能优化**
   - 内存泄漏修复（Flow收集优化）
   - 数据库查询优化（解决N+1查询、添加索引）
   - Compose重组优化（@Stable/@Immutable注解）

3. **文档完善**
   - 创建模块README.md
   - 编写API使用指南
   - 更新架构文档

## 💻 开发环境

### 构建工具
- Gradle: 8.4
- AGP: 8.2.0
- KSP: 1.9.21-1.0.15

### 关键依赖版本
- Compose BOM: 2023.10.01
- Compose Compiler: 1.5.7
- Hilt: 2.48.1
- Room: 2.6.1
- Retrofit: 2.9.0
- WorkManager: 2.9.0

### 编译命令
```bash
# 清理并构建
./gradlew clean build

# 仅编译调试版本
./gradlew assembleDebug

# 编译特定模块
./gradlew :feature:schedule:compileDebugKotlin

# 运行测试
./gradlew test
```

## 🛠️ 当前技术债务

### 需要优化的项
1. Excel导出功能（需要Apache POI库）
2. 数据导入功能（当前只有导出）
3. 更多的单元测试覆盖
4. 性能监控和分析工具集成

### 待开发的高优先级功能
1. 日记模块（规划中）
2. 经期模块（规划中）
3. 小部件支持
4. 深度链接支持

## 📋 快速开始下次开发

### 1. 检查项目状态
```bash
git status
git log --oneline -5
```

### 2. 验证编译环境
```bash
./gradlew :app:compileDebugKotlin
```

### 3. 查看待办事项
使用 TodoRead 工具查看当前任务列表

### 4. 参考关键文档
- `doc/架构迁移进度追踪.md` - 详细迁移记录
- `doc/模块架构详解.md` - 模块结构说明
- `doc/功能模块待开发.md` - 功能开发清单
- `CLAUDE.md` - Claude Code行为规范

## ⚠️ 注意事项

### 模块依赖规则
- ✅ 允许：app → feature → shared → core
- ❌ 禁止：横向依赖、反向依赖

### 数据库管理
- 当前版本：6
- 修改实体后需要创建迁移文件
- 迁移文件位置：`core/database/src/.../migrations/`

### 代码规范
- 所有响应使用中文
- 遵循Kotlin编码规范
- 使用KDoc注释公共API
- 保持模块结构一致性

## 🔗 相关资源

### 项目文档
- [架构迁移完整指南](doc/架构迁移完整指南.md)
- [性能基准测试报告](doc/性能基准测试报告.md)
- [排班模块API使用指南](doc/排班模块API使用指南.md)

### 开发工具
- Android Studio Hedgehog | 2023.1.1+
- WSL环境配置脚本：`scripts/setup_wsl_build_env.sh`

---

**提示**：本文档反映截至2025年6月14日的项目状态。CC小记已成功完成从单体架构到模块化架构的全面迁移，现进入功能优化和新功能开发阶段。