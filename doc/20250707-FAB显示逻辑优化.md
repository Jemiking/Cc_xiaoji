# CC小记 - FAB显示逻辑优化

> 执行时间：2025年1月7日
> 执行人：Claude Code
> 文档版本：v1.0

## 📋 问题描述

用户反馈：悬浮操作按钮（FAB）在所有页面都显示，包括进入记账、待办等模块内部页面，这不符合设计逻辑。

## 🔍 问题分析

**原因**：FAB是在MainActivity的Scaffold级别定义的，导致它成为全局组件，在所有页面都会显示。

**影响**：
- 在模块内页面显示FAB会造成功能混乱
- 某些页面可能有自己的FAB，会产生冲突
- 不符合"快捷操作"主要服务于首页的设计初衷

## ✅ 解决方案

### 实现条件渲染

在`MainActivity.kt`中添加路由判断逻辑：

```kotlin
// 获取当前路由
val navBackStackEntry by navController.currentBackStackEntryAsState()
val currentRoute = navBackStackEntry?.destination?.route

// 条件渲染FAB
floatingActionButton = {
    // 只在首页显示FAB
    if (currentRoute == Screen.Home.route) {
        QuickActionFAB(navController = navController)
    }
}
```

### 技术细节

1. 使用`currentBackStackEntryAsState()`监听导航状态变化
2. 通过`destination?.route`获取当前页面路由
3. 只有当路由等于`Screen.Home.route`时才渲染FAB

## 📊 效果

- ✅ FAB只在首页显示
- ✅ 进入其他模块后FAB自动隐藏
- ✅ 返回首页时FAB重新显示
- ✅ 不影响各模块内部可能存在的FAB

## 📁 修改的文件

```
app/src/main/java/com/ccxiaoji/app/presentation/
└── MainActivity.kt
    - 添加了路由状态监听
    - 实现了FAB的条件渲染
    - 添加了必要的import语句
```

## 💡 设计理念

这个改动体现了以下设计原则：
1. **上下文相关性**：UI元素应该只在相关的上下文中出现
2. **功能清晰性**：快捷操作按钮明确定位为首页功能
3. **避免干扰**：在专注的任务页面不显示无关元素

---
*文档创建时间：2025-01-07*