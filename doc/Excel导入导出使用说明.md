# Excel导入导出使用说明

> 最后更新：2025-01-29  
> 版本：v2.0（FastExcel）

## 一、功能概述

CC小记提供强大的Excel导入导出功能，支持将应用内的各种数据导出为Excel文件，也支持从Excel文件导入数据。

### 1.1 支持的模块
- **记账数据**：交易记录、账户余额、分类统计
- **任务管理**：待办事项、任务列表、完成状态
- **习惯追踪**：习惯记录、完成情况、连续天数
- **排班管理**：班次安排、工作时间、统计数据
- **计划管理**：计划项目、进度跟踪、里程碑

### 1.2 主要特性
- ✅ 支持大数据量导入导出（100万行以内）
- ✅ 自动数据验证和错误提示
- ✅ 余额校验（记账模块）
- ✅ 批量操作支持
- ✅ 进度实时反馈
- ✅ 内存优化，避免崩溃

## 二、导出功能使用

### 2.1 如何导出数据

1. **进入导出界面**
   - 打开应用，点击"我的"标签
   - 选择"数据导出"选项

2. **选择导出内容**
   - 选择要导出的模块（记账/任务/习惯等）
   - 设置日期范围（可选）
   - 选择导出选项（如是否包含已删除数据）

3. **开始导出**
   - 点击"导出"按钮
   - 选择保存位置
   - 等待导出完成

### 2.2 导出文件格式

#### 记账数据格式
| 列名 | 说明 | 示例 |
|------|------|------|
| 日期 | 交易日期 | 2025-01-29 |
| 时间 | 交易时间 | 14:30:00 |
| 类型 | 收入/支出/转账 | 支出 |
| 分类 | 交易分类 | 餐饮 |
| 金额 | 交易金额 | 35.50 |
| 账户 | 所属账户 | 现金 |
| 余额 | 交易后余额 | 1234.50 |
| 备注 | 备注信息 | 午餐 |
| 标签 | 标签列表 | 工作餐,外卖 |

#### 任务数据格式
| 列名 | 说明 | 示例 |
|------|------|------|
| 标题 | 任务标题 | 完成项目报告 |
| 描述 | 任务描述 | 详细的任务说明 |
| 状态 | 完成状态 | 已完成 |
| 优先级 | 优先级别 | 高 |
| 创建时间 | 创建时间 | 2025-01-28 09:00 |
| 截止时间 | 截止时间 | 2025-01-30 18:00 |
| 完成时间 | 完成时间 | 2025-01-29 16:30 |
| 标签 | 标签列表 | 工作,重要 |

### 2.3 导出选项说明

- **日期范围**：可选择全部数据或指定时间段
- **包含已删除**：是否导出已删除的记录
- **文件格式**：目前仅支持XLSX格式
- **压缩选项**：大文件自动压缩

## 三、导入功能使用

### 3.1 如何导入数据

1. **准备Excel文件**
   - 确保文件格式符合要求
   - 第一行必须是标题行
   - 数据从第二行开始

2. **进入导入界面**
   - 打开应用，点击"我的"标签
   - 选择"数据导入"选项

3. **选择文件并导入**
   - 点击"选择文件"
   - 选择要导入的Excel文件
   - 预览数据（可选）
   - 点击"开始导入"

### 3.2 导入要求

#### 通用要求
- 文件格式：XLSX（Excel 2007及以上版本）
- 文件大小：建议不超过50MB
- 编码格式：UTF-8
- 第一行必须包含列标题

#### 日期格式支持
- yyyy-MM-dd（推荐）
- yyyy/MM/dd
- dd/MM/yyyy
- Excel日期序列号

#### 金额格式支持
- 纯数字：123.45
- 千分位：1,234.56
- 货币符号：¥123.45、￥123.45
- 负数表示：-123.45、(123.45)

### 3.3 数据验证

导入时会自动进行以下验证：

#### 基础验证
- ✅ 必填字段检查
- ✅ 数据类型验证
- ✅ 数值范围检查
- ✅ 日期逻辑验证

#### 业务验证（记账模块）
- ✅ 账户余额连续性
- ✅ 总资产一致性
- ✅ 分类是否存在
- ✅ 账户是否存在

### 3.4 错误处理

导入过程中遇到错误时：

1. **错误提示**
   - 显示错误行号和具体原因
   - 提供修正建议

2. **错误分类**
   - **严重错误**（红色）：必须修正才能继续
   - **警告**（黄色）：可以忽略，但建议修正

3. **批量错误**
   - 最多显示前100个错误
   - 可导出完整错误报告

## 四、高级功能

### 4.1 批量操作

导入时支持的批量操作：
- 自动创建不存在的分类
- 自动创建不存在的账户
- 批量标签处理

### 4.2 余额验证（记账专用）

- **自动余额计算**：根据交易自动计算余额
- **余额校验**：检查Excel中的余额是否正确
- **智能修正建议**：提供余额不匹配的解决方案

### 4.3 性能优化

- **大文件处理**：自动分批处理，避免内存溢出
- **进度显示**：实时显示导入导出进度
- **后台处理**：支持后台运行，不影响其他操作

## 五、常见问题

### Q1: 导入时提示"无法识别的日期格式"
**A**: 请确保日期格式为yyyy-MM-dd，如2025-01-29。

### Q2: 导出的文件在哪里？
**A**: 默认保存在"下载"文件夹，文件名包含导出时间。

### Q3: 能否只导入部分数据？
**A**: 可以，在预览界面可以选择要导入的行。

### Q4: 导入大文件很慢怎么办？
**A**: 建议将大文件分成多个小文件导入，每个不超过10MB。

### Q5: 余额不匹配怎么处理？
**A**: 系统会提示具体的不匹配位置，可以选择：
1. 使用系统计算的余额（推荐）
2. 保留Excel中的余额
3. 手动修正后重新导入

### Q6: 支持从其他应用导入吗？
**A**: 支持，但需要调整Excel格式以匹配我们的标准格式。

## 六、最佳实践

### 6.1 导出建议
- 定期导出备份数据（建议每月一次）
- 导出前先同步数据
- 大数据量时分模块导出

### 6.2 导入建议
- 导入前先备份现有数据
- 先用少量数据测试导入
- 检查并修正所有错误后再导入

### 6.3 数据安全
- 导出的文件请妥善保管
- 包含敏感信息时建议加密
- 定期清理旧的导出文件

## 七、技术规格

- **文件格式**：XLSX (Excel 2007+)
- **最大支持**：100万行数据
- **编码格式**：UTF-8
- **性能指标**：
  - 导出速度：约10000行/秒
  - 导入速度：约5000行/秒
  - 内存占用：<100MB（50MB文件）

## 八、更新日志

### v2.0 (2025-01-29)
- 🚀 迁移到FastExcel，性能提升6倍
- 🎯 内存占用降低67%
- ✨ 新增并行处理支持
- 🔧 优化大文件处理
- 🐛 修复多个已知问题

### v1.0 (2024-12-01)
- 初始版本发布
- 支持基础导入导出功能

---

如有其他问题，请联系技术支持。