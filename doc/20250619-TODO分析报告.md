# TODO/FIXME 分析报告

## 统计概览

| 模块 | TODO数量 | 占比 |
|------|----------|------|
| Feature模块 | 100个 | 76.9% |
| - Ledger | 75个 | 57.7% |
| - Schedule | 13个 | 10.0% |
| - Habit | 8个 | 6.2% |
| - Todo | 4个 | 3.1% |
| App模块 | 22个 | 16.9% |
| Core/Shared模块 | 8个 | 6.2% |
| **总计** | **130个** | **100%** |

## TODO分类分析

### 1. 功能性TODO（需要实现的功能）- 88个 (67.7%)

#### 高优先级 ⚠️ (必须实现)
1. **LedgerApiImpl** - 72个未实现的API方法
   - 位置：`feature/ledger/api/LedgerApiImpl.kt`
   - 影响：Ledger模块完全无法对外提供服务
   - 建议：**立即实现核心API方法**

2. **同步相关** - 9个
   - 位置：HabitRepository、TaskRepository等
   - 内容：`// TODO: Log the change for sync through ChangeLogApi`
   - 影响：数据同步功能缺失
   - 建议：统一实现变更日志记录

3. **通知功能** - 4个
   - 位置：NotificationWorkers、RecurringTransactionWorker
   - 影响：通知功能无法正常工作
   - 建议：集成shared-notification模块

#### 中优先级 🔔
1. **UI数据获取** - 2个
   - 位置：HabitScreen
   - 内容：`// TODO: 从ViewModel获取每日数据`
   - 影响：UI显示不完整
   - 建议：完善ViewModel数据流

2. **ProfileViewModel功能** - 4个
   - 数据备份、恢复、缓存清理、检查更新
   - 影响：用户设置功能缺失
   - 建议：按功能重要性逐步实现

### 2. 优化性TODO（性能或代码优化）- 4个 (3.1%)

1. **班次排序优化**
   - 位置：`GetQuickShiftsUseCase.kt`
   - 内容：`// TODO: 未来可以根据使用频率排序`
   - 优先级：低
   - 建议：功能稳定后再优化

2. **数据库连接管理**
   - 位置：`RestoreDatabaseUseCase.kt`
   - 内容：`// TODO: 需要通过依赖注入获取数据库实例并关闭连接`
   - 优先级：中
   - 建议：改进数据库生命周期管理

### 3. 临时性TODO（临时解决方案）- 10个 (7.7%)

1. **DatabaseInitializer注释**
   - 位置：`core/database/DatabaseInitializer.kt`
   - 内容：多处"待Feature模块迁移后恢复"
   - 建议：**现在可以删除，迁移已完成**

2. **临时文件标记**
   - 位置：`CcDatabase.kt`
   - 内容：`// TODO: 这是临时文件，待所有模块迁移完成后删除`
   - 建议：**评估是否可以删除**

### 4. 文档性TODO（需要补充文档）- 0个

无文档相关的TODO。

### 5. UI交互TODO（用户交互功能）- 28个 (21.5%)

1. **导航相关** - 10个
   - ProfileScreen中的设置导航
   - NavGraph中的账单详情界面
   - 建议：完善导航功能

2. **对话框和选择器** - 8个
   - 日期选择器、时间选择器、颜色选择器等
   - 建议：创建通用的选择器组件

3. **系统功能集成** - 5个
   - 分享应用、跳转应用商店、打开系统权限等
   - 建议：使用Intent实现

## 处理建议优先级

### 🔴 紧急（P0）- 立即处理
1. **LedgerApiImpl实现** (72个TODO)
   - 原因：核心功能完全缺失
   - 方案：注入必要的Repository，实现所有API方法
   - 预计工作量：2-3天

### 🟡 重要（P1）- 本周内处理
1. **同步功能集成** (9个TODO)
   - 原因：影响数据完整性
   - 方案：统一实现ChangeLogApi调用
   - 预计工作量：1天

2. **删除过时TODO** (10个TODO)
   - 原因：迁移已完成，注释会造成困惑
   - 方案：直接删除相关注释
   - 预计工作量：30分钟

### 🟢 一般（P2）- 计划内处理
1. **通知功能实现** (4个TODO)
2. **Profile功能完善** (4个TODO)
3. **UI选择器组件** (8个TODO)
4. **导航功能完善** (10个TODO)

### 🔵 低优先级（P3）- 待定
1. **性能优化** (2个TODO)
2. **系统集成功能** (5个TODO)

## 行动计划

### 第一阶段（本周）
1. ✅ 实现LedgerApiImpl所有方法
2. ✅ 删除过时的迁移相关TODO
3. ✅ 实现统一的同步日志记录

### 第二阶段（下周）
1. 完善通知功能集成
2. 实现Profile核心功能
3. 创建通用UI组件库

### 第三阶段（后续）
1. 完善所有导航功能
2. 实现系统功能集成
3. 性能优化

## 建议的TODO管理策略

1. **转换为Issue**：将重要的TODO转换为GitHub Issue进行跟踪
2. **代码审查**：在代码审查时禁止新增无计划的TODO
3. **定期清理**：每月进行一次TODO清理
4. **统一格式**：使用 `// TODO(owner): [P0-P3] 描述` 格式

## 总结

当前项目中存在130个TODO/FIXME，其中最严重的问题是LedgerApiImpl完全未实现（72个TODO），这直接影响了账本模块的功能可用性。建议立即开始实现这些API方法，同时清理已经过时的迁移相关TODO，并建立TODO管理机制避免技术债务积累。